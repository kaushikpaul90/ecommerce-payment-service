# name: CI/CD Pipeline

# on:
#   pull_request:
#     branches:
#       - main
#   push:
#     branches:
#       - main

# jobs:
#   build-and-deploy:
#     runs-on: ubuntu-latest

#     steps:
#       - name: Checkout code
#         uses: actions/checkout@v3

#       - name: Set up Docker Buildx
#         uses: docker/setup-buildx-action@v2

#       - name: Log in to Docker Hub
#         uses: docker/login-action@v2
#         with:
#           username: ${{ secrets.DOCKER_HUB_USERNAME }}
#           password: ${{ secrets.DOCKER_HUB_PASSWORD }}

#       - name: Build Docker image
#         run: |
#           docker build -t ${{ secrets.DOCKER_HUB_USERNAME }}/payment-service:latest .

#       - name: Push Docker image
#         run: |
#           docker push ${{ secrets.DOCKER_HUB_USERNAME }}/payment-service:latest

#       - name: Set up kubectl
#         uses: azure/setup-kubectl@v3
#         with:
#           version: 'v1.30.0'

#       - name: Deploy to Minikube
#         run: |
#           export DOCKER_HUB_USERNAME=${{ secrets.DOCKER_HUB_USERNAME }}
#           envsubst < k8s/payment-deployment-template.yaml > k8s/payment-service-deployment.yaml
#           kubectl apply -f k8s/payment-deployment-template.yaml
#           kubectl apply -f k8s/payment-service-template.yaml
